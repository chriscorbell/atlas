<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Domain &#43; Cloudflare &#43; Caddy Reverse Proxy - Atlas</title>
    <meta name="description"
        content="Your resource for building a home server that serves your needs, not the cloud&#39;s." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap"
        rel="stylesheet" />
    <script>
        document.documentElement.classList.remove('no-js');
        document.documentElement.classList.add('has-js');
    </script>
    
    <link rel="stylesheet" href="https://atlas.neovoid.cc/styles.css" />
</head>

<body>
    <header class="site-header">
        <div class="container header-inner">
            <a href="/" class="logo">Atlas</a>
            <nav class="primary-nav" aria-label="Main navigation">
                <a href="/">Home</a>
                <a href="/blueprint/foundation">Blueprint</a>
            </nav>
        </div>
    </header>

    <main>
        
<section class="section blueprint-page" id="blueprint-top">
    <div class="container blueprint-layout">
        <aside class="blueprint-sidebar" aria-label="Blueprint outline" data-appear data-appear-group="blueprint">
            <h2>Blueprint</h2>
            <nav class="blueprint-nav" aria-label="Section navigation">
                <ol>
                    
                    
                    
                    <li>
                        <a href="/blueprint/00-foundation/" >Foundation</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/slskd-lidarr/" >Music Acquisition: slskd &#43; Lidarr</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/01-hardware/" >Hardware</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/02-proxmox/" >Proxmox</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/03-truenas/" >TrueNAS</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/04-haos/" >HAOS</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/05-debian/" >Debian</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/06-nas-access/" >NAS Access</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/07-tailscale/" >Tailscale</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/08-docker/" >Docker</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/09-filebrowser/" >File Management: FileBrowser</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/10-crafty/" >Minecraft Server: Crafty</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/11-nginx/" >Web Server: NGINX</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/12-torrents/" >Torrents: qBittorrent &#43; VueTorrent &#43; Gluetun</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/13-movies-tv/" >Movies/TV Libraries</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/14-jellyfin/" >Jellyfin</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/16-navidrome/" >Music Streaming: Navidrome &#43; Mobile Clients</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/17-immich/" >Photos: Immich &#43; Mobile Backup over Tailscale</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/18-n8n/" >Workflow Automation: n8n</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/19-llms/" >Local LLMs: Ollama &#43; OpenWebUI</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/20-paperless-ngx/" >Document Management: Paperless-ngx</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/21-watchtower/" >Watchtower</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/22-domain/"  aria-current="page" >Domain &#43; Cloudflare &#43; Caddy Reverse Proxy</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/23-backup/" >Backup NAS &#43; ZFS Replication</a>
                    </li>
                    
                    <li>
                        <a href="/blueprint/24-extras/" >Extras: Monitoring, Backups, UPS, Hygiene</a>
                    </li>
                    
                </ol>
            </nav>
        </aside>

        <div class="blueprint-content">
            <section class="blueprint-section" data-appear data-appear-group="blueprint">
                <header>
                    
                    <p class="step-meta">Phase 22</p>
                    
                    <h2>Domain &#43; Cloudflare &#43; Caddy Reverse Proxy</h2>
                </header>
                
                <div class="step-list">
                    <p>This page covers using a domain + Cloudflare DNS and setting up <strong>Caddy</strong> as a reverse proxy.</p>
<h2 id="choose-your-access-model">Choose your access model</h2>
<h3 id="model-a-recommended-private-only-via-tailscale">Model A (recommended): private-only via Tailscale</h3>
<ul>
<li>No port forwarding</li>
<li>Access services from anywhere via tailnet IP/name</li>
<li>Most secure for beginners</li>
</ul>
<h3 id="model-b-public-https-access">Model B: public HTTPS access</h3>
<ul>
<li>Requires forwarding ports 80/443</li>
<li>Requires strong security practices</li>
<li>Consider Cloudflare Tunnel if you want fewer inbound ports</li>
</ul>
<h2 id="1-buy-a-domain--add-to-cloudflare">1) Buy a domain + add to Cloudflare</h2>
<ol>
<li>Register a domain</li>
<li>Add it to Cloudflare</li>
<li>Update nameservers at the registrar to Cloudflare’s nameservers</li>
</ol>
<h2 id="2-plan-your-subdomains">2) Plan your subdomains</h2>
<p>Examples:</p>
<ul>
<li><code>jellyfin.example.com</code></li>
<li><code>immich.example.com</code></li>
<li><code>n8n.example.com</code></li>
</ul>
<h2 id="3-run-caddy-in-docker">3) Run Caddy in Docker</h2>
<p>Create: <code>~/docker/compose/core/caddy.compose.yml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#c9c9c9;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#bc74c4">services</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#bc74c4">caddy</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#bc74c4">image</span><span style="color:#56b6c2">:</span> caddy:latest
</span></span><span style="display:flex;"><span>    <span style="color:#bc74c4">container_name</span><span style="color:#56b6c2">:</span> caddy
</span></span><span style="display:flex;"><span>    <span style="color:#bc74c4">ports</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#82cc6a">&#34;80:80&#34;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#82cc6a">&#34;443:443&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#bc74c4">volumes</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>      - ~/docker/appdata/caddy/Caddyfile:/etc/caddy/Caddyfile
</span></span><span style="display:flex;"><span>      - ~/docker/appdata/caddy/data:/data
</span></span><span style="display:flex;"><span>      - ~/docker/appdata/caddy/config:/config
</span></span><span style="display:flex;"><span>    <span style="color:#bc74c4">restart</span><span style="color:#56b6c2">:</span> unless-stopped
</span></span><span style="display:flex;"><span>    <span style="color:#bc74c4">networks</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>      - proxy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bc74c4">networks</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#bc74c4">proxy</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#bc74c4">external</span><span style="color:#56b6c2">:</span> <span style="color:#cf5967;background-color:#43454f">true</span>
</span></span></code></pre></div><h3 id="example-caddyfile">Example Caddyfile</h3>
<p>Create: <code>~/docker/appdata/caddy/Caddyfile</code></p>
<div class="highlight"><pre tabindex="0" style="color:#c9c9c9;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-caddy" data-lang="caddy"><span style="display:flex;"><span><span style="color:#ecbe7b;font-weight:bold">jellyfin.example.com</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#7fbaf5">reverse_proxy</span> jellyfin<span style="color:#56b6c2">:</span><span style="color:#56b6c2">8096</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ecbe7b;font-weight:bold">n8n.example.com</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#7fbaf5">reverse_proxy</span> n8n<span style="color:#56b6c2">:</span><span style="color:#56b6c2">5678</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ecbe7b;font-weight:bold">file.example.com</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#7fbaf5">reverse_proxy</span> filebrowser<span style="color:#56b6c2">:</span><span style="color:#56b6c2">80</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span></code></pre></div><p>Start:</p>
<div class="highlight"><pre tabindex="0" style="color:#c9c9c9;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker compose -f ~/docker/compose/core/caddy.compose.yml up -d
</span></span></code></pre></div><h2 id="4-dns-records-in-cloudflare">4) DNS records in Cloudflare</h2>
<ul>
<li>For public access: point A/AAAA records to your public IP</li>
<li>For Tailscale-only: you can point to Tailscale IP for your own devices, but it won’t be globally reachable</li>
</ul>
<h2 id="next">Next</h2>
<p>Proceed to: <strong><a href="23-backup-nas-replication.md">Backup NAS + Replication</a></strong></p>
<hr>
<p><strong>Navigation:</strong> ← <a href="21-watchtower.md">Auto Updates: Watchtower</a> | <a href="23-backup-nas-replication.md">Backup NAS + ZFS Replication</a> →</p>

                </div>

                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                

                <div class="blueprint-pagination">
                    
                    
                    
                    
                    <a href="/blueprint/21-watchtower/" rel="prev" class="button button-outline">← Watchtower</a>
                    

                    
                    
                    <a href="/blueprint/23-backup/" rel="next" class="button">Backup NAS &#43; ZFS Replication →</a>
                    
                </div>
            </section>
        </div>
    </div>
</section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('pre').forEach(function (pre) {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.textContent = 'Copy';
                button.setAttribute('aria-label', 'Copy code to clipboard');

                button.addEventListener('click', async function () {
                    const code = pre.querySelector('code');
                    const text = code ? code.textContent : pre.textContent;

                    try {
                        await navigator.clipboard.writeText(text);
                        button.textContent = 'Copied!';
                        button.classList.add('copied');

                        setTimeout(function () {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    } catch (err) {
                        console.error('Failed to copy:', err);
                        button.textContent = 'Error';
                    }
                });

                pre.appendChild(button);
            });

            
            const appearElements = Array.from(document.querySelectorAll('[data-appear]'));
            if (appearElements.length) {
                document.body.classList.add('is-appear-ready');
                const groups = new Map();

                window.requestAnimationFrame(function () {
                    appearElements.forEach(function (element) {
                        const group = element.getAttribute('data-appear-group') || 'default';
                        const index = groups.get(group) || 0;
                        element.style.setProperty('--stagger-index', String(index));

                        const delayAttr = element.getAttribute('data-appear-delay');
                        if (delayAttr !== null) {
                            const delayValue = Number(delayAttr);
                            if (!Number.isNaN(delayValue)) {
                                element.style.setProperty('--appear-delay', delayValue + 'ms');
                            }
                        }

                        groups.set(group, index + 1);
                        element.classList.add('is-visible');
                    });
                });
            }
        });
    </script>
</body>

</html>